# JavaWeb基础

## 1. JavaWeb简介

### 1.1 JavaWeb的定义与应用场景

JavaWeb是指使用Java技术进行Web应用开发的总称。Web应用是指基于浏览器/服务器（B/S）架构，通过互联网或局域网为用户提供服务的软件系统。JavaWeb技术广泛应用于企业级网站、管理系统、电子商务、在线教育、社交平台等领域。

### 1.2 JavaWeb三层架构

JavaWeb开发通常采用三层架构：

- 表示层（Web层）：负责与用户交互，接收请求并展示数据，常用Servlet、JSP等技术实现。
- 业务逻辑层（Service层）：处理具体的业务逻辑，如用户注册、登录、订单处理等。
- 数据访问层（DAO层）：负责与数据库进行交互，实现数据的增删改查。

三层架构有助于代码解耦、便于维护和扩展。

### 1.3 常见开发工具与环境

- JDK（Java Development Kit）：Java开发的基础环境。
- IDE（集成开发环境）：如IntelliJ IDEA、Eclipse等。
- Web服务器：如Tomcat、Jetty等。
- 构建工具：如Maven、Gradle。
- 数据库：如MySQL、Oracle、PostgreSQL等。

## 2. Web基础知识

### 2.1 HTTP协议基础

HTTP（超文本传输协议）是Web通信的基础协议。它是无状态的、基于请求-响应模式的协议。常见的HTTP方法有GET、POST、PUT、DELETE等。

### 2.2 浏览器与服务器的通信流程

1. 用户在浏览器输入URL并回车。
2. 浏览器将请求发送到服务器。
3. 服务器处理请求，返回响应数据（如HTML页面）。
4. 浏览器解析并渲染页面。

### 2.3 URL、URI、请求与响应

- URL（统一资源定位符）：定位互联网上的资源，如 `http://www.example.com/index.html`。
- URI（统一资源标识符）：资源的唯一标识，可以是URL，也可以是URN。
- 请求（Request）：客户端向服务器发送的数据。
- 响应（Response）：服务器返回给客户端的数据。

## 3. Servlet技术

### 3.1 Servlet简介

Servlet是运行在服务器端的小型Java程序，用于接收和响应Web客户端的请求。Servlet是JavaWeb的核心技术之一。

server applet 服务器程序

### 3.2 Servlet生命周期

Servlet的生命周期包括：

1. 加载与实例化：由服务器（如Tomcat）加载Servlet类并创建其实例。
2. 初始化（init方法）：只调用一次，用于初始化资源。
3. 请求处理（service方法）：每次请求都会调用，用于处理业务逻辑。
4. 销毁（destroy方法）：服务器关闭或Servlet被卸载时调用，用于释放资源。

### 3.3 Servlet API详解

Servlet API主要包括以下接口和类：

- `javax.servlet.Servlet`：Servlet接口，定义了生命周期方法。
- `javax.servlet.http.HttpServlet`：常用的Servlet基类，简化了HTTP请求处理。
- `javax.servlet.ServletRequest`和 `ServletResponse`：请求和响应对象。

### 3.4 Servlet配置与映射

Servlet需要在 `web.xml`中进行配置，或使用注解 `@WebServlet`进行映射。例如：

```xml
<servlet>
	<servlet-name>HelloServlet</servlet-name>
	<servlet-class>com.example.HelloServlet</servlet-class>
</servlet>
<servlet-mapping>
	<servlet-name>HelloServlet</servlet-name>
	<url-pattern>/hello</url-pattern>
</servlet-mapping>
```

或：

```java
@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
	// ...
}
```

### 3.5 请求与响应对象

- `HttpServletRequest`：封装了客户端请求信息，如参数、请求头、Cookie等。
- `HttpServletResponse`：用于向客户端返回数据，如设置响应头、输出内容等。

---

## 4. JSP技术

### 4.1 JSP简介

JSP（JavaServer Pages）是一种动态网页开发技术，本质上是Servlet的简化和扩展。JSP允许在HTML页面中嵌入Java代码，便于开发和维护动态网页。

### 4.2 JSP与Servlet的关系

JSP最终会被Web服务器（如Tomcat）编译为Servlet类。JSP适合页面展示，Servlet适合处理业务逻辑。两者结合使用可以实现清晰的分层。

### 4.3 JSP语法与指令

- 指令（Directive）：如 `<%@ page %>`、`<%@ include %>`、`<%@ taglib %>`。
- 脚本元素：
  - 声明：`<%! int count = 0; %>`
  - 脚本片段：`<% count++; %>`
  - 表达式：`<%= count %>`

### 4.4 JSP内置对象

JSP提供了九大内置对象，常用的有：

- request：请求对象
- response：响应对象
- session：会话对象
- application：全局应用对象
- out：输出流对象
- config、page、pageContext、exception

### 4.5 JSP工作原理

JSP页面第一次被访问时会被编译为Servlet，后续访问直接执行Servlet类，提高了性能。

### 4.6 JSP与MVC模式

JSP通常作为MVC模式中的视图层（View），负责数据展示。

## 5. JavaBean与EL表达式

### 5.1 JavaBean规范

JavaBean是遵循特定规范的Java类，通常用于封装数据。规范包括：

- 公有类
- 提供无参构造方法
- 属性私有，提供getter/setter方法

### 5.2 JavaBean在JSP中的使用

通过 `<jsp:useBean>`、`<jsp:setProperty>`、`<jsp:getProperty>`标签在JSP中操作JavaBean，实现数据的封装与传递。

### 5.3 EL表达式基础

EL（Expression Language）表达式用于简化JSP页面中对数据的访问，语法如 `${user.name}`，可直接访问作用域中的对象属性。

### 5.4 JSP与JavaBean结合

JSP页面通过EL表达式和JavaBean结合，实现数据的展示与交互，提升了开发效率和页面可维护性。

## 6. 会话管理

### 6.1 Cookie原理

Cookie是服务器发送到客户端并保存在本地的小型文本数据。常用于保存用户登录状态、个性化设置等。Cookie有大小和数量限制，且容易被用户清除。

### 6.2 Session原理

Session是服务器端保存用户会话数据的机制。每个用户访问时，服务器会分配唯一的Session ID，客户端通过Cookie或URL重写方式传递Session ID。

### 6.3 Cookie与Session的区别

- Cookie数据保存在客户端，Session数据保存在服务器端。
- Session更安全，但占用服务器资源。
- 实际开发中常结合使用：如登录状态用Session，个性化偏好用Cookie。

### 6.4 会话管理的安全性

要防止Session劫持、固定攻击等安全问题，建议：

- 使用HTTPS加密传输
- 合理设置Session超时时间
- 重要操作后更换Session ID

---

## 7. MVC设计模式

### 7.1 MVC模式简介

MVC（Model-View-Controller，模型-视图-控制器）是一种经典的软件架构模式，将应用分为三部分：

- Model（模型）：封装数据和业务逻辑，如JavaBean、Service、DAO等。
- View（视图）：负责数据展示，通常由JSP、HTML等实现。
- Controller（控制器）：负责接收请求、调用业务逻辑、转发页面，常用Servlet实现。

MVC模式有助于分离关注点，提高代码的可维护性和可扩展性。

### 7.2 JavaWeb中的MVC实现

在JavaWeb项目中，常见的MVC实现方式：

- Servlet作为Controller，负责请求分发和业务调用。
- JavaBean/Service/DAO作为Model，负责数据处理。
- JSP作为View，负责页面展示。

### 7.3 框架中的MVC

如Spring MVC、Struts等框架对MVC模式进行了进一步封装和优化，简化了开发流程。

## 8. 数据库与JDBC

### 8.1 数据库基础

数据库用于持久化存储数据，常见的关系型数据库有MySQL、Oracle、SQL Server等。Web应用通过数据库实现数据的增删改查。

### 8.2 JDBC原理与使用

JDBC（Java Database Connectivity）是Java访问数据库的标准API。基本流程：

1. 加载数据库驱动
2. 获取数据库连接
3. 创建Statement/PreparedStatement对象
4. 执行SQL语句
5. 处理结果集ResultSet
6. 关闭资源

示例代码：

```java
Class.forName("com.mysql.cj.jdbc.Driver");
Connection conn = DriverManager.getConnection(url, user, password);
PreparedStatement ps = conn.prepareStatement("SELECT * FROM user WHERE id = ?");
ps.setInt(1, 1);
ResultSet rs = ps.executeQuery();
while(rs.next()) {
	System.out.println(rs.getString("username"));
}
rs.close();
ps.close();
conn.close();
```

### 8.3 数据库连接池

数据库连接池（如Druid、C3P0、HikariCP）用于管理数据库连接，提升性能，避免频繁创建和销毁连接。

## 9. 常用开发框架

### 9.1 Spring框架简介

Spring是目前最流行的Java企业级开发框架，核心特性包括IOC（控制反转）、AOP（面向切面编程）、声明式事务等。Spring极大地简化了JavaWeb开发。

### 9.2 Spring MVC

Spring MVC是Spring的子模块，实现了强大的Web MVC架构。它通过注解和配置简化了请求分发、参数绑定、视图解析等流程。

### 9.3 MyBatis

MyBatis是优秀的ORM（对象关系映射）框架，简化了JDBC操作，支持自定义SQL、存储过程和高级映射。

### 9.4 Spring Boot

Spring Boot是Spring生态的重要组成部分，提供了开箱即用的自动配置和快速开发能力，大幅提升了JavaWeb项目的开发效率。

## 10. 项目实战与部署

### 10.1 JavaWeb项目结构

典型的JavaWeb项目结构如下：

```
project-root/
├── src/
│   ├── main/
│   │   ├── java/           # Java源代码
│   │   ├── resources/      # 配置文件、资源文件
│   │   └── webapp/         # Web资源（HTML、JSP、静态文件等）
│   └── test/               # 测试代码
├── pom.xml                 # Maven配置文件
└── README.md
```

### 10.2 本地开发与调试

- 使用IDEA/Eclipse等工具创建Web项目，配置Tomcat等服务器。
- 通过断点调试、日志输出等方式排查问题。
- 推荐使用Maven/Gradle进行依赖管理和构建。

### 10.3 部署到服务器

1. 打包项目为war/jar文件。
2. 上传到服务器，配置Tomcat/Nginx等环境。
3. 配置数据库连接、环境变量等。
4. 启动服务并测试访问。

### 10.4 常见问题与调试技巧

- 端口冲突、依赖冲突、编码问题
- 日志分析、异常堆栈定位
- 数据库连接失败、权限不足

## 11. 安全与优化

### 11.1 常见Web安全问题

- XSS（跨站脚本攻击）：用户输入未过滤直接输出到页面
- CSRF（跨站请求伪造）：利用用户登录态发起恶意请求
- SQL注入：用户输入拼接到SQL语句导致数据库被攻击
- 文件上传漏洞、会话劫持等

### 11.2 安全防护建议

- 所有用户输入都要校验和过滤
- 重要操作使用验证码、二次确认
- 合理设置Session/Cookie属性
- 数据库操作使用预编译语句（PreparedStatement）
- 及时修复依赖漏洞，定期安全扫描

### 11.3 性能优化建议

- 使用连接池、缓存、CDN等提升性能
- 静态资源分离、压缩、合并
- 数据库索引优化、SQL调优
- 合理分页、异步处理

## 12. 未来发展与学习建议

### 12.1 JavaWeb技术趋势

- 微服务架构（Spring Cloud、Dubbo等）
- 前后端分离（Vue、React、Angular等前端框架）
- 云原生、容器化（Docker、Kubernetes）
- DevOps与自动化部署

### 12.2 学习建议

- 夯实Java基础，理解面向对象思想
- 深入掌握Servlet、JSP、JDBC、Spring等核心技术
- 多做项目实践，参与开源项目
- 关注社区动态，持续学习新技术

---

本教程为JavaWeb基础入门。
